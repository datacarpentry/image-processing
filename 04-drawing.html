<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Image Processing with Python: Drawing and Bitwise Operations</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="assets/images/data-logo.svg"></div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/04-drawing.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Image Processing with Python
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Image Processing with Python
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="edge-detection.html">Extra Episode: Edge Detection</a></li><li><a class="dropdown-item" href="prereqs.html">Prerequisites</a></li><li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Image Processing with Python
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 23%" class="percentage">
    23%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 23%" aria-valuenow="23" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/04-drawing.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-image-basics.html">2. Image Basics</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-skimage-images.html">3. Working with scikit-image</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Drawing and Bitwise Operations
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#first-import-the-packages-needed-for-this-episode">First, import the packages needed for this episode</a></li>
<li><a href="#drawing-on-images">Drawing on images</a></li>
<li><a href="#image-modification">Image modification</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-creating-histograms.html">5. Creating Histograms</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-blurring.html">6. Blurring Images</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-thresholding.html">7. Thresholding</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-connected-components.html">8. Connected Component Analysis</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-challenges.html">9. Capstone Challenge</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li><li><a href="edge-detection.html">Extra Episode: Edge Detection</a></li><li><a href="prereqs.html">Prerequisites</a></li><li><a href="reference.html">Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="03-skimage-images.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="05-creating-histograms.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="03-skimage-images.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Working with
        </a>
        <a class="chapter-link float-end" href="05-creating-histograms.html" rel="next">
          Next: Creating Histograms... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Drawing and Bitwise Operations</h1>
        <p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/datacarpentry/image-processing/edit/main/episodes/04-drawing.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can we draw on scikit-image images and use bitwise operations
and masks to select certain parts of an image?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Create a blank, black scikit-image image.</li>
<li>Draw rectangles and other shapes on scikit-image images.</li>
<li>Explain how a white shape on a black background can be used as a
mask to select specific parts of an image.</li>
<li>Use bitwise operations to apply a mask to an image.</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>The next series of episodes covers a basic toolkit of scikit-image
operators. With these tools, we will be able to create programs to
perform simple analyses of images based on changes in colour or
shape.</p>
<section id="first-import-the-packages-needed-for-this-episode"><h2 class="section-heading">First, import the packages needed for this episode<a class="anchor" aria-label="anchor" href="#first-import-the-packages-needed-for-this-episode"></a>
</h2>
<hr class="half-width"><div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> imageio.v3 <span class="im">as</span> iio</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> ipympl</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="im">import</span> skimage <span class="im">as</span> ski</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="op">%</span>matplotlib widget</span></code></pre>
</div>
<p>Here, we import the same packages as earlier in the lesson.</p>
</section><section id="drawing-on-images"><h2 class="section-heading">Drawing on images<a class="anchor" aria-label="anchor" href="#drawing-on-images"></a>
</h2>
<hr class="half-width"><p>Often we wish to select only a portion of an image to analyze, and
ignore the rest. Creating a rectangular sub-image with slicing, as we
did in <a href="03-skimage-images.html">the <em>Working with
scikit-image</em> episode</a> is one option for simple cases. Another
option is to create another special image, of the same size as the
original, with white pixels indicating the region to save and black
pixels everywhere else. Such an image is called a <em>mask</em>. In
preparing a mask, we sometimes need to be able to draw a shape - a
circle or a rectangle, say - on a black image. scikit-image provides
tools to do that.</p>
<p>Consider this image of maize seedlings:</p>
<figure><img src="fig/maize-seedlings.jpg" alt="Maize seedlings" class="figure mx-auto d-block"></figure><p>Now, suppose we want to analyze only the area of the image containing
the roots themselves; we do not care to look at the kernels, or anything
else about the plants. Further, we wish to exclude the frame of the
container holding the seedlings as well. Hovering over the image with
our mouse, could tell us that the upper-left coordinate of the sub-area
we are interested in is <em>(44, 357)</em>, while the lower-right
coordinate is <em>(720, 740)</em>. These coordinates are shown in
<em>(x, y)</em> order.</p>
<p>A Python program to create a mask to select only that area of the
image would start with a now-familiar section of code to open and
display the original image:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Load and display the original image</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>maize_seedlings <span class="op">=</span> iio.imread(uri<span class="op">=</span><span class="st">"data/maize-seedlings.tif"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>ax.imshow(maize_seedlings)</span></code></pre>
</div>
<p>We load and display the initial image in the same way we have done
before.</p>
<p>NumPy allows indexing of images/arrays with “boolean” arrays of the
same size. Indexing with a boolean array is also called mask indexing.
The “pixels” in such a mask array can only take two values:
<code>True</code> or <code>False</code>. When indexing an image with
such a mask, only pixel values at positions where the mask is
<code>True</code> are accessed. But first, we need to generate a mask
array of the same size as the image. Luckily, the NumPy library provides
a function to create just such an array. The next section of code shows
how:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Create the basic mask</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>mask <span class="op">=</span> np.ones(shape<span class="op">=</span>maize_seedlings.shape[<span class="dv">0</span>:<span class="dv">2</span>], dtype<span class="op">=</span><span class="st">"bool"</span>)</span></code></pre>
</div>
<p>The first argument to the <code>ones()</code> function is the shape
of the original image, so that our mask will be exactly the same size as
the original. Notice, that we have only used the first two indices of
our shape. We omitted the channel dimension. Indexing with such a mask
will change all channel values simultaneously. The second argument,
<code>dtype = "bool"</code>, indicates that the elements in the array
should be booleans - i.e., values are either <code>True</code> or
<code>False</code>. Thus, even though we use <code>np.ones()</code> to
create the mask, its pixel values are in fact not <code>1</code> but
<code>True</code>. You could check this, e.g., by
<code>print(mask[0, 0])</code>.</p>
<p>Next, we draw a filled, rectangle on the mask:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Draw filled rectangle on the mask image</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>rr, cc <span class="op">=</span> ski.draw.rectangle(start<span class="op">=</span>(<span class="dv">357</span>, <span class="dv">44</span>), end<span class="op">=</span>(<span class="dv">740</span>, <span class="dv">720</span>))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>mask[rr, cc] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># Display mask image</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>ax.imshow(mask, cmap<span class="op">=</span><span class="st">"gray"</span>)</span></code></pre>
</div>
<p>Here is what our constructed mask looks like: <img src="fig/maize-seedlings-mask.png" class="image-with-shadow figure" alt="Maize image mask"></p>
<p>The parameters of the <code>rectangle()</code> function
<code>(357, 44)</code> and <code>(740, 720)</code>, are the coordinates
of the upper-left (<code>start</code>) and lower-right
(<code>end</code>) corners of a rectangle in <em>(ry, cx)</em> order.
The function returns the rectangle as row (<code>rr</code>) and column
(<code>cc</code>) coordinate arrays.</p>
<div id="check-the-documentation" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="check-the-documentation" class="callout-inner">
<h3 class="callout-title">Check the documentation!<a class="anchor" aria-label="anchor" href="#check-the-documentation"></a>
</h3>
<div class="callout-content">
<p>When using an scikit-image function for the first time - or the fifth
time - it is wise to check how the function is used, via <a href="https://scikit-image.org/docs/dev/user_guide" class="external-link">the scikit-image
documentation</a> or other usage examples on programming-related sites
such as <a href="https://stackoverflow.com/" class="external-link">Stack Overflow</a>. Basic
information about scikit-image functions can be found interactively in
Python, via commands like <code>help(ski)</code> or
<code>help(ski.draw.rectangle)</code>. Take notes in your lab notebook.
And, it is always wise to run some test code to verify that the
functions your program uses are behaving in the manner you intend.</p>
</div>
</div>
</div>
<div id="variable-naming-conventions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="variable-naming-conventions" class="callout-inner">
<h3 class="callout-title">Variable naming conventions!<a class="anchor" aria-label="anchor" href="#variable-naming-conventions"></a>
</h3>
<div class="callout-content">
<p>You may have wondered why we called the return values of the
rectangle function <code>rr</code> and <code>cc</code>?! You may have
guessed that <code>r</code> is short for <code>row</code> and
<code>c</code> is short for <code>column</code>. However, the rectangle
function returns mutiple rows and columns; thus we used a convention of
doubling the letter <code>r</code> to <code>rr</code> (and
<code>c</code> to <code>cc</code>) to indicate that those are multiple
values. In fact it may have even been clearer to name those variables
<code>rows</code> and <code>columns</code>; however this would have been
also much longer. Whatever you decide to do, try to stick to some
already existing conventions, such that it is easier for other people to
understand your code.</p>
</div>
</div>
</div>
<div id="other-drawing-operations-15-min" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="other-drawing-operations-15-min" class="callout-inner">
<h3 class="callout-title">Other drawing operations (15 min)<a class="anchor" aria-label="anchor" href="#other-drawing-operations-15-min"></a>
</h3>
<div class="callout-content">
<p>There are other functions for drawing on images, in addition to the
<code>ski.draw.rectangle()</code> function. We can draw circles, lines,
text, and other shapes as well. These drawing functions may be useful
later on, to help annotate images that our programs produce. Practice
some of these functions here.</p>
<p>Circles can be drawn with the <code>ski.draw.disk()</code> function,
which takes two parameters: the (ry, cx) point of the centre of the
circle, and the radius of the circle. There is an optional
<code>shape</code> parameter that can be supplied to this function. It
will limit the output coordinates for cases where the circle dimensions
exceed the ones of the image.</p>
<p>Lines can be drawn with the <code>ski.draw.line()</code> function,
which takes four parameters: the (ry, cx) coordinate of one end of the
line, and the (ry, cx) coordinate of the other end of the line.</p>
<p>Other drawing functions supported by scikit-image can be found in <a href="https://scikit-image.org/docs/dev/api/skimage.draw.html?highlight=draw#module-skimage.draw" class="external-link">the
scikit-image reference pages</a>.</p>
<p>First let’s make an empty, black image with a size of 800x600 pixels.
Recall that a colour image has three channels for the colours red,
green, and blue (RGB, cf. <a href="03-skimage-images.html">Image
Basics</a>). Hence we need to create a 3D array of shape
<code>(600, 800, 3)</code> where the last dimension represents the RGB
colour channels.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># create the black canvas</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>canvas <span class="op">=</span> np.zeros(shape<span class="op">=</span>(<span class="dv">600</span>, <span class="dv">800</span>, <span class="dv">3</span>), dtype<span class="op">=</span><span class="st">"uint8"</span>)</span></code></pre>
</div>
<p>Now your task is to draw some other coloured shapes and lines on the
image, perhaps something like this:</p>
<figure><img src="fig/drawing-practice.jpg" alt="Sample shapes" class="figure mx-auto d-block"></figure></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>Drawing a circle:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Draw a blue circle with centre (200, 300) in (ry, cx) coordinates, and radius 100</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>rr, cc <span class="op">=</span> ski.draw.disk(center<span class="op">=</span>(<span class="dv">200</span>, <span class="dv">300</span>), radius<span class="op">=</span><span class="dv">100</span>, shape<span class="op">=</span>canvas.shape[<span class="dv">0</span>:<span class="dv">2</span>])</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>canvas[rr, cc] <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>)</span></code></pre>
</div>
<p>Drawing a line:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Draw a green line from (400, 200) to (500, 700) in (ry, cx) coordinates</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>rr, cc <span class="op">=</span> ski.draw.line(r0<span class="op">=</span><span class="dv">400</span>, c0<span class="op">=</span><span class="dv">200</span>, r1<span class="op">=</span><span class="dv">500</span>, c1<span class="op">=</span><span class="dv">700</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>canvas[rr, cc] <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Display the image</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>ax.imshow(canvas)</span></code></pre>
</div>
<p>We could expand this solution, if we wanted, to draw rectangles,
circles and lines at random positions within our black canvas. To do
this, we could use the <code>random</code> python module, and the
function <code>random.randrange</code>, which can produce random numbers
within a certain range.</p>
<p>Let’s draw 15 randomly placed circles:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co"># create the black canvas</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>canvas <span class="op">=</span> np.zeros(shape<span class="op">=</span>(<span class="dv">600</span>, <span class="dv">800</span>, <span class="dv">3</span>), dtype<span class="op">=</span><span class="st">"uint8"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co"># draw a blue circle at a random location 15 times</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">15</span>):</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    rr, cc <span class="op">=</span> ski.draw.disk(center<span class="op">=</span>(</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>         random.randrange(<span class="dv">600</span>),</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>         random.randrange(<span class="dv">800</span>)),</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>         radius<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>         shape<span class="op">=</span>canvas.shape[<span class="dv">0</span>:<span class="dv">2</span>],</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>        )</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>    canvas[rr, cc] <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co"># display the results</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>ax.imshow(canvas)</span></code></pre>
</div>
<p>We could expand this even further to also randomly choose whether to
plot a rectangle, a circle, or a square. Again, we do this with the
<code>random</code> module, now using the function
<code>random.random</code> that returns a random number between 0.0 and
1.0.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co"># Draw 15 random shapes (rectangle, circle or line) at random positions</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">15</span>):</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    <span class="co"># generate a random number between 0.0 and 1.0 and use this to decide if we</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="co"># want a circle, a line or a sphere</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    x <span class="op">=</span> random.random()</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">&lt;</span> <span class="fl">0.33</span>:</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>        <span class="co"># draw a blue circle at a random location</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>        rr, cc <span class="op">=</span> ski.draw.disk(center<span class="op">=</span>(</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>            random.randrange(<span class="dv">600</span>),</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>            random.randrange(<span class="dv">800</span>)),</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>            radius<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>            shape<span class="op">=</span>canvas.shape[<span class="dv">0</span>:<span class="dv">2</span>],</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>        )</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>        color <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>)</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>    <span class="cf">elif</span> x <span class="op">&lt;</span> <span class="fl">0.66</span>:</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>        <span class="co"># draw a green line at a random location</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>        rr, cc <span class="op">=</span> ski.draw.line(</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>            r0<span class="op">=</span>random.randrange(<span class="dv">600</span>),</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>            c0<span class="op">=</span>random.randrange(<span class="dv">800</span>),</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>            r1<span class="op">=</span>random.randrange(<span class="dv">600</span>),</span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>            c1<span class="op">=</span>random.randrange(<span class="dv">800</span>),</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>        )</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>        color <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">255</span>, <span class="dv">0</span>)</span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>        <span class="co"># draw a red rectangle at a random location</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>        rr, cc <span class="op">=</span> ski.draw.rectangle(</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>            start<span class="op">=</span>(random.randrange(<span class="dv">600</span>), random.randrange(<span class="dv">800</span>)),</span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>            extent<span class="op">=</span>(<span class="dv">50</span>, <span class="dv">50</span>),</span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>            shape<span class="op">=</span>canvas.shape[<span class="dv">0</span>:<span class="dv">2</span>],</span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>        )</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>        color <span class="op">=</span> (<span class="dv">255</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>    canvas[rr, cc] <span class="op">=</span> color</span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a><span class="co"># display the results</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a>ax.imshow(canvas)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="image-modification"><h2 class="section-heading">Image modification<a class="anchor" aria-label="anchor" href="#image-modification"></a>
</h2>
<hr class="half-width"><p>All that remains is the task of modifying the image using our mask in
such a way that the areas with <code>True</code> pixels in the mask are
not shown in the image any more.</p>
<div id="how-does-a-mask-work-optional-not-included-in-timing" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="how-does-a-mask-work-optional-not-included-in-timing" class="callout-inner">
<h3 class="callout-title">How does a mask work? (optional, not included
in timing)<a class="anchor" aria-label="anchor" href="#how-does-a-mask-work-optional-not-included-in-timing"></a>
</h3>
<div class="callout-content">
<p>Now, consider the mask image we created above. The values of the mask
that corresponds to the portion of the image we are interested in are
all <code>False</code>, while the values of the mask that corresponds to
the portion of the image we want to remove are all
<code>True</code>.</p>
<p>How do we change the original image using the mask?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>When indexing the image using the mask, we access only those pixels
at positions where the mask is <code>True</code>. So, when indexing with
the mask, one can set those values to 0, and effectively remove them
from the image.</p>
</div>
</div>
</div>
</div>
<p>Now we can write a Python program to use a mask to retain only the
portions of our maize roots image that actually contains the seedling
roots. We load the original image and create the mask in the same way as
before:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Load the original image</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>maize_seedlings <span class="op">=</span> iio.imread(uri<span class="op">=</span><span class="st">"data/maize-seedlings.tif"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># Create the basic mask</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>mask <span class="op">=</span> np.ones(shape<span class="op">=</span>maize_seedlings.shape[<span class="dv">0</span>:<span class="dv">2</span>], dtype<span class="op">=</span><span class="st">"bool"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co"># Draw a filled rectangle on the mask image</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>rr, cc <span class="op">=</span> ski.draw.rectangle(start<span class="op">=</span>(<span class="dv">357</span>, <span class="dv">44</span>), end<span class="op">=</span>(<span class="dv">740</span>, <span class="dv">720</span>))</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>mask[rr, cc] <span class="op">=</span> <span class="va">False</span></span></code></pre>
</div>
<p>Then, we use NumPy indexing to remove the portions of the image,
where the mask is <code>True</code>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Apply the mask</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>maize_seedlings[mask] <span class="op">=</span> <span class="dv">0</span></span></code></pre>
</div>
<p>Then, we display the masked image.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>ax.imshow(maize_seedlings)</span></code></pre>
</div>
<p>The resulting masked image should look like this:</p>
<figure><img src="fig/maize-seedlings-masked.jpg" alt="Applied mask" class="figure mx-auto d-block"></figure><div id="masking-an-image-of-your-own-optional-not-included-in-timing" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="masking-an-image-of-your-own-optional-not-included-in-timing" class="callout-inner">
<h3 class="callout-title">Masking an image of your own (optional, not
included in timing)<a class="anchor" aria-label="anchor" href="#masking-an-image-of-your-own-optional-not-included-in-timing"></a>
</h3>
<div class="callout-content">
<p>Now, it is your turn to practice. Using your mobile phone, tablet,
webcam, or digital camera, take an image of an object with a simple
overall geometric shape (think rectangular or circular). Copy that image
to your computer, write some code to make a mask, and apply it to select
the part of the image containing your object. For example, here is an
image of a remote control:</p>
<figure><img src="data/remote-control.jpg" alt="Remote control image" class="figure mx-auto d-block"></figure><p>And, here is the end result of a program masking out everything but
the remote:</p>
<figure><img src="fig/remote-control-masked.jpg" alt="Remote control masked" class="figure mx-auto d-block"></figure></div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>Here is a Python program to produce the cropped remote control image
shown above. Of course, your program should be tailored to your
image.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Load the image</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>remote <span class="op">=</span> iio.imread(uri<span class="op">=</span><span class="st">"data/remote-control.jpg"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>remote <span class="op">=</span> np.array(remote)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co"># Create the basic mask</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>mask <span class="op">=</span> np.ones(shape<span class="op">=</span>remote.shape[<span class="dv">0</span>:<span class="dv">2</span>], dtype<span class="op">=</span><span class="st">"bool"</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co"># Draw a filled rectangle on the mask image</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>rr, cc <span class="op">=</span> ski.draw.rectangle(start<span class="op">=</span>(<span class="dv">93</span>, <span class="dv">1107</span>), end<span class="op">=</span>(<span class="dv">1821</span>, <span class="dv">1668</span>))</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>mask[rr, cc] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co"># Apply the mask</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>remote[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>ax.imshow(remote)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="masking-a-96-well-plate-image-30-min" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="masking-a-96-well-plate-image-30-min" class="callout-inner">
<h3 class="callout-title">Masking a 96-well plate image (30 min)<a class="anchor" aria-label="anchor" href="#masking-a-96-well-plate-image-30-min"></a>
</h3>
<div class="callout-content">
<p>Consider this image of a 96-well plate that has been scanned on a
flatbed scanner.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Load the image</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>wellplate <span class="op">=</span> iio.imread(uri<span class="op">=</span><span class="st">"data/wellplate-01.jpg"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>wellplate <span class="op">=</span> np.array(wellplate)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co"># Display the image</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>ax.imshow(wellplate)</span></code></pre>
</div>
<figure><img src="data/wellplate-01.jpg" alt="96-well plate" class="figure mx-auto d-block"></figure><p>Suppose that we are interested in the colours of the solutions in
each of the wells. We <em>do not</em> care about the colour of the rest
of the image, i.e., the plastic that makes up the well plate itself.</p>
<p>Your task is to write some code that will produce a mask that will
mask out everything except for the wells. To help with this, you should
use the text file <code>data/centers.txt</code> that contains the (cx,
ry) coordinates of the centre of each of the 96 wells in this image. You
may assume that each of the wells has a radius of 16 pixels.</p>
<p>Your program should produce output that looks like this:</p>
<figure><img src="fig/wellplate-01-masked.jpg" alt="Masked 96-well plate" class="figure mx-auto d-block"></figure></div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># read in original image</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>wellplate <span class="op">=</span> iio.imread(uri<span class="op">=</span><span class="st">"data/wellplate-01.jpg"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>wellplate <span class="op">=</span> np.array(wellplate)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># create the mask image</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>mask <span class="op">=</span> np.ones(shape<span class="op">=</span>wellplate.shape[<span class="dv">0</span>:<span class="dv">2</span>], dtype<span class="op">=</span><span class="st">"bool"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># open and iterate through the centers file...</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"data/centers.txt"</span>, <span class="st">"r"</span>) <span class="im">as</span> center_file:</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> center_file:</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>        <span class="co"># ... getting the coordinates of each well...</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>        coordinates <span class="op">=</span> line.split()</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>        cx <span class="op">=</span> <span class="bu">int</span>(coordinates[<span class="dv">0</span>])</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>        ry <span class="op">=</span> <span class="bu">int</span>(coordinates[<span class="dv">1</span>])</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>        <span class="co"># ... and drawing a circle on the mask</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>        rr, cc <span class="op">=</span> ski.draw.disk(center<span class="op">=</span>(ry, cx), radius<span class="op">=</span><span class="dv">16</span>, shape<span class="op">=</span>wellplate.shape[<span class="dv">0</span>:<span class="dv">2</span>])</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>        mask[rr, cc] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co"># apply the mask</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>wellplate[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co"># display the result</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>ax.imshow(wellplate)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="masking-a-96-well-plate-image-take-two-optional-not-included-in-timing" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="masking-a-96-well-plate-image-take-two-optional-not-included-in-timing" class="callout-inner">
<h3 class="callout-title">Masking a 96-well plate image, take two
(optional, not included in timing)<a class="anchor" aria-label="anchor" href="#masking-a-96-well-plate-image-take-two-optional-not-included-in-timing"></a>
</h3>
<div class="callout-content">
<p>If you spent some time looking at the contents of the
<code>data/centers.txt</code> file from the previous challenge, you may
have noticed that the centres of each well in the image are very
regular. <em>Assuming</em> that the images are scanned in such a way
that the wells are always in the same place, and that the image is
perfectly oriented (i.e., it does not slant one way or another), we
could produce our well plate mask without having to read in the
coordinates of the centres of each well. Assume that the centre of the
upper left well in the image is at location cx = 91 and ry = 108, and
that there are 70 pixels between each centre in the cx dimension and 72
pixels between each centre in the ry dimension. Each well still has a
radius of 16 pixels. Write a Python program that produces the same
output image as in the previous challenge, but <em>without</em> having
to read in the <code>centers.txt</code> file. <em>Hint: use nested for
loops.</em></p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>Here is a Python program that is able to create the masked image
without having to read in the <code>centers.txt</code> file.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># read in original image</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>wellplate <span class="op">=</span> iio.imread(uri<span class="op">=</span><span class="st">"data/wellplate-01.jpg"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>wellplate <span class="op">=</span> np.array(wellplate)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co"># create the mask image</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>mask <span class="op">=</span> np.ones(shape<span class="op">=</span>wellplate.shape[<span class="dv">0</span>:<span class="dv">2</span>], dtype<span class="op">=</span><span class="st">"bool"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co"># upper left well coordinates</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>cx0 <span class="op">=</span> <span class="dv">91</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>ry0 <span class="op">=</span> <span class="dv">108</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co"># spaces between wells</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>deltaCX <span class="op">=</span> <span class="dv">70</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>deltaRY <span class="op">=</span> <span class="dv">72</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>cx <span class="op">=</span> cx0</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>ry <span class="op">=</span> ry0</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co"># iterate each row and column</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">12</span>):</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>    <span class="co"># reset cx to leftmost well in the row</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>    cx <span class="op">=</span> cx0</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>    <span class="cf">for</span> col <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">8</span>):</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>        <span class="co"># ... and drawing a circle on the mask</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a>        rr, cc <span class="op">=</span> ski.draw.disk(center<span class="op">=</span>(ry, cx), radius<span class="op">=</span><span class="dv">16</span>, shape<span class="op">=</span>wellplate.shape[<span class="dv">0</span>:<span class="dv">2</span>])</span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>        mask[rr, cc] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a>        cx <span class="op">+=</span> deltaCX</span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a>    <span class="co"># after one complete row, move to next row</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a>    ry <span class="op">+=</span> deltaRY</span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co"># apply the mask</span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a>wellplate[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="co"># display the result</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a>ax.imshow(wellplate)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>We can use the NumPy <code>zeros()</code> function to create a
blank, black image.</li>
<li>We can draw on scikit-image images with functions such as
<code>ski.draw.rectangle()</code>, <code>ski.draw.disk()</code>,
<code>ski.draw.line()</code>, and more.</li>
<li>The drawing functions return indices to pixels that can be set
directly.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="03-skimage-images.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="05-creating-histograms.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="03-skimage-images.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Working with
        </a>
        <a class="chapter-link float-end" href="05-creating-histograms.html" rel="next">
          Next: Creating Histograms... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/image-processing/edit/main/episodes/04-drawing.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/image-processing/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/image-processing/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/image-processing/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.5" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.2" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/image-processing/04-drawing.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Drawing and Bitwise Operations",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/image-processing/04-drawing.html",
  "identifier": "https://datacarpentry.github.io/image-processing/04-drawing.html",
  "dateCreated": "2017-03-14",
  "dateModified": "2024-03-12",
  "datePublished": "2024-04-30"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

